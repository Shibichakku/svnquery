<meta http-equiv="Content-Type" content="text/html; charset=UTF-8" />ï»¿ <style>  CODE {  	COLOR: #800000  }</style><h3>Summary </h3><p>SvnQuery helps you finding files in your subversion repository like Google helps you finding pages on the internet. It does a full text search for content and metadata like filename, path, author and arbitrary svn properties.</p><h3>How does it work?</h3><p>SvnQuery maintains a full text index (powered by <span lang="de">L</span>ucene) of the repository which is used for fast querying. This index needs to be created once for an existing repository. When the repository changes the index needs to be updated. This is usually triggered by a simple post-commit hook. Indexing is done in a detached background process, so users don't notice any delay when committing to the repository. </p><p>Alternatively, if you have no access to the repository, you can choose to do scheduled updates, e.g. once a day. This is useful if you want to index a remote subversion repository where you cannot use hooks. On Windows you can use <a href="http://support.microsoft.com/kb/308569">Scheduled Tasks</a> to do this</p><p>SvnQuery's frontend is an ASP.NET web application similar to a typical web search engine. You enter a query and milliseconds later you see your hits. You can not only search the head revision but also all revisions at once or an arbitrary custom revision range. SvnFind is another frontend that runs under windows and gives you direct access to the index without the need to install the web application. There is one core library, SvnQuery.dll, which implements a simple but powerful query language especially suited to query code repositories. Hopefully other application, tools or addins will make use of this library. </p><h3>Detailed Documentation</h3><p>SvnQuery currently consists of three parts</p><ol><li><a href="http://svnquery.tigris.org/servlets/ProjectProcess?pageID=o0dpdE#SvnIndex">SvnIndex</a>, a command line tool for creating and updating the full text index </li><li><a href="http://svnquery.tigris.org/servlets/ProjectProcess?pageID=o0dpdE#SvnWebQuery">SvnWebQuery</a>, an ASP.NET web application for querying the index </li><li><a href="http://svnquery.tigris.org/cn-project-pages/Documentation/#SvnFind">SvnFind</a>, a rich (windows) client for querying&nbsp; the index</li><li><a href="http://svnquery.tigris.org/servlets/ProjectProcess?pageID=o0dpdE#SvnQuery">SvnQuery.dll</a>, a programmers library which can be used to query the index </li></ol><h4><a name="SvnIndex"></a>SvnIndex - Maintaining the repository index</h4><p>The command line tool SvnIndex maintains the full text index of a subversion repository. It has two subcommands for creating and updating an index. </p><p><code>svnindex create <index /></index /><repository />[Options]</code></p><p>Creates a new index at <code>Index</code> for the repository located at <code>Repository</code>. Any existing content at <code>Index</code> will be overwritten.&nbsp; The <code>-r </code>option (filter) specifies up to which revision the index will be created. If <code>-r</code> is omitted the head revision will be used. Depending on the size of your repository indexing could take quite a long time. It is a good idea to initially index only a few revisions and check if the basic mechanisms work. Then update the index later to the head revision. With the -f option (filter) you can exclude items matching the given regular expression from being indexed. E.g. you might want to exclude the &quot;tags&quot; folder to prevent an excessively big index. As tags are by convention only copies of the trunk or branches you don't loose much information. </p><p><code>svnindex update <index /></index /><repository />[Options]</code></p><p>Updates an existing index at <code>Index</code> for the repository located at <code>Repository</code>. The <code>-r</code> option specifies the youngest revision to be included in the index. If <code>-r</code> is omitted the head revision will be used.&nbsp; </p><p><code>Index</code> is always a path to a folder in the local filesystem. <code>Repository</code> is either a path to a repository in the local filesystem or a valid url of a repository accessed by the svn: or http: protocol. </p><h5>All options</h5><p><code>-r</code> max revision to be included in the index<br /><code>-u</code> User (if using the svn: or http: protocol)<br /><code>-p</code> Password<br /><code>-f</code> regex filter for items that should be ignored, e.g. &quot;.*/tags/.*&quot;<br /><code>-t</code> max number of threads used to query the repository in parallel<br /><code>-c</code> commit interval (number of revisions that are written to the index in a transaction)<br /><code>-o</code> optimize interval (number of&nbsp; revisions between index optimization) <br /><code>-n</code> name of the index (for display in clients e.g. SvnWebQuery)<br /><code>-x</code> external visible repository uri (for downloadable result sets) <br /><code>-v</code> log verbosity level (0..3, 0 is lowest, 1 is default) </p><h4>An example of how to use SvnIndex</h4><p>In our example the repository is located at <a href="file:///e:/Repository">e:\Repository</a> and the index is located at <a href="file:///e:/RepositoryIndex">e:\RepositoryIndex</a>. The repository is served by svnserve on a server named &quot;server&quot;.</p><ol><li>Copy the SvnIndex folder to&nbsp;the hooks folder of your repository. (This has the additional benefit that your svnquery installation gets backuped together with the repository)&nbsp; </li><li>Create the initial index with the following command. Depending on the size of your repository this can take quite some time:<br /><span style="background: #ffffcc">svnindex create e:\RepositoryIndex e:\Repository -x svn://server -n &quot;Source Repository&quot; -f &quot;(/tags/)|(/branches/)&quot;</span> </li><li>Create a <code>post-commit.cmd</code> file inside the hooks folder.</li><li>Paste the following line into it:<br /><span style="background: #ffffcc">%~dp0SvnIndex\RunDetached %~dp0SvnIndex\svnindex.exe update e:\RepositoryIndex e:\Repository -f &quot;(/tags/)|(/branches/)&quot;<br /></span>&nbsp;Note that RunDetached is a little helper exe that spawns and detaches a new process so that the repository process is not blocked by the indexing task. </li><li>Thats it!</li></ol><h4><a name="SvnWebQuery"></a>SvnWebQuery Web Frontend</h4><p>SvnWebQuery is an ASP.NET web site which lets the user query the index maintained by SvnIndex. You need IIS and the .NET Framework 3.5 installed. It was tested with IIS 6.0 but should work with any version that is able to serve ASP.NET pages. You need to setup an virtual directory, e.g. &quot;search&quot; and let it point to to the SvnWebQuery directory contained in the distribution. </p><p><a href="/cn-project-pages/Documentation/SvnWebQuerySetup/">Detailed Setup Instructions</a> of how to setup SvnWebQuery with IIS 6.0 are available. For other IIS versions the process should be similar. After you have finished the setup process browse to the search page, enter your query (google like) and press search or enter. Usage help is available on the integrated <a title="SvnWebQuery Help Page" href="/cn-project-pages/Documentation/SvnWebQueryHelp/">help page</a>.</p><h4><a name="SvnFind"></a>SvnFind Windows Application&nbsp;&nbsp;</h4><p>If you have direct access to the index files you can use SvnFind to query the index. No need to bother with IIS installation. Just start SvnFind and enter your query through a typical windows user interface.</p><p>&nbsp;</p><h4><a name="SvnQuery"></a>SvnQuery Code Library</h4><p>The SvnQuery Library is not intended for end users and of interest for developers only. Make yourself comfortable with the code by checking it out and visiting the <a href="http://svnquery.tigris.org/wiki/FrontPage">Wiki</a> pages.</p>